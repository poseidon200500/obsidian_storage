---
tags:
  - Программирование
  - Безопасность
  - CORS
---
## CORS механизм

CORS (Cross-Origin Resource Sharing) — это механизм, который позволяет ограничивать доступ к ресурсам веб-приложения с других доменов. Он используется для обеспечения безопасности, предотвращая несанкционированный доступ к ресурсам.

### Настройка в Go
Для настройки CORS в Go можно использовать следующий код:

```go
func enableCORS(w *http.ResponseWriter) {
    (*w).Header().Set("Access-Control-Allow-Origin", "https://trusted.com")
    (*w).Header().Set("Access-Control-Allow-Methods", "GET, POST")
    (*w).Header().Set("Access-Control-Allow-Headers", "Content-Type")
}
```
В этом примере устанавливаются заголовки, которые разрешают доступ к ресурсам только с домена `https://trusted.com`, а также определяются допустимые методы и заголовки.

---

### Типовые сценарии

- **Простые запросы**: 
  - Это запросы, которые используют методы GET или POST с допустимыми заголовками (например, `Content-Type: application/json`). Браузер автоматически добавляет необходимые CORS-заголовки, если сервер правильно настроен.

- **Предварительные запросы**: 
  - Для сложных операций (например, запросы с методами PUT или DELETE) браузер сначала отправляет запрос типа OPTIONS, чтобы проверить, разрешает ли сервер такие операции. Сервер должен ответить с соответствующими CORS-заголовками.

- **Учетные данные (withCredentials)**: 
  - Если необходимо отправлять учетные данные (например, cookies или HTTP-авторизацию), сервер должен установить заголовок `Access-Control-Allow-Credentials: true`. Также в заголовке `Access-Control-Allow-Origin` не может быть указано значение `*`, а должен быть указан конкретный домен.

---

CORS является важным механизмом для обеспечения безопасности веб-приложений, позволяя контролировать, какие домены могут взаимодействовать с ресурсами вашего сервера.