---
tags:
  - ВебОсновы
  - Безопасность
  - Программирование
  - Начало
---
# Безопасность веб-приложений

---

## Угрозы веб-безопасности
**XSS (Cross-Site Scripting)**  
Атака, при которой злоумышленник внедряет вредоносный JavaScript-код  
- **Пример уязвимости**:  
  ```html
  <div>{{пользовательский_ввод}}</div> <!-- Без экранирования -->
  ```
- **Защита**: Использование `html/template` в Go, CSP-заголовки

**CSRF (Cross-Site Request Forgery)**  
Подделка запросов от имени пользователя  
- **Пример**:  
  ```html
  <img src="https://bank.com/transfer?to=hacker&amount=1000">
  ```
- **Защита**: CSRF-токены, SameSite cookies

**SQL-инъекции**  
Внедрение SQL-команд через пользовательский ввод  
- **Пример уязвимости**:  
  ```go
  db.Query("SELECT * FROM users WHERE login = '" + input + "'")
  ```
- **Защита**: Prepared statements, ORM

Подробнее: [[Угрозы веб-безопасности]]

---

## Аутентификация и авторизация
**Cookies**  
- Установка в Go:  
  ```go
  http.SetCookie(w, &http.Cookie{
    Name:     "token",
    Value:    "abc123",
    HttpOnly: true,
    Secure:   true,
    SameSite: http.SameSiteStrictMode,
  })
  ```

**JWT (JSON Web Tokens)**  
- Структура: Header.Payload.Signature  
- Пример:  
  ```
  eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
  ```

**OAuth2**  
Популярные потоки:  
- Authorization Code (для веб-приложений)  
- Client Credentials (сервис-сервис)  
- Implicit (устаревший)  

Подробнее: [[Механизмы аутентификации]]

---

## CORS механизм
**Настройка в Go**:  
```go
func enableCORS(w *http.ResponseWriter) {
    (*w).Header().Set("Access-Control-Allow-Origin", "https://trusted.com")
    (*w).Header().Set("Access-Control-Allow-Methods", "GET, POST")
    (*w).Header().Set("Access-Control-Allow-Headers", "Content-Type")
}
```

**Типовые сценарии**:  
- Простые запросы (GET, POST с допустимыми Content-Type)  
- Предварительные запросы (OPTIONS) для сложных операций  
- Учетные данные (withCredentials)

Подробнее: [[Настройка CORS]]

---

## Сравнительная таблица

| Технология       | Использование                  | Риски                     |
|------------------|--------------------------------|--------------------------|
| Cookies          | Сессии, простые токены         | CSRF, XSS                |
| JWT              | Stateless-аутентификация       | Подделка токенов         |
| OAuth2           | Делегированный доступ         | Утечка refresh-токенов   |
| CORS             | Кросс-доменные запросы        | Неправильная настройка   |
