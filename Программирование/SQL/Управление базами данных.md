---
tags:
  - Программирование
  - SQL
  - Основы_языка_SQL
---
### **Создание и управление базами данных в SQL**

---

#### **1. Создание базы данных (CREATE DATABASE)**

**Базовый синтаксис:**
```sql
CREATE DATABASE database_name
[CHARACTER SET charset_name]
[COLLATE collation_name];
```

**Примеры:**

1. Простое создание БД:
```sql
CREATE DATABASE ecommerce;
```

2. С указанием кодировки (MySQL):
```sql
CREATE DATABASE ecommerce 
CHARACTER SET utf8mb4 
COLLATE utf8mb4_unicode_ci;
```

3. С проверкой на существование:
```sql
CREATE DATABASE IF NOT EXISTS ecommerce;
```

**Особенности:**
- В PostgreSQL кодировка задается при создании кластера
- MySQL по умолчанию использует `latin1`, лучше явно указывать `utf8mb4`

---

#### **2. Удаление базы данных (DROP DATABASE)**

**Синтаксис:**
```sql
DROP DATABASE [IF EXISTS] database_name;
```

**Примеры:**

1. Базовое удаление:
```sql
DROP DATABASE old_database;
```

2. Безопасное удаление:
```sql
DROP DATABASE IF EXISTS temp_database;
```

**Важно!**
- Операция необратима
- В PostgreSQL нельзя удалить БД, если есть подключения (кроме через `postgres`)

---

#### **3. Изменение базы данных (ALTER DATABASE)**

**Основные возможности:**

1. Изменение кодировки (MySQL):
```sql
ALTER DATABASE ecommerce 
CHARACTER SET utf8mb4 
COLLATE utf8mb4_0900_ai_ci;
```

2. Изменение параметров (PostgreSQL):
```sql
ALTER DATABASE ecommerce 
SET enable_indexscan = off;
```

3. Переименование (нестандартное):
- MySQL: нет прямого способа (нужно дамп/восстановление)
- PostgreSQL: 
```sql
ALTER DATABASE old_name RENAME TO new_name;
```

---

#### **4. Системные таблицы и метаданные**

**MySQL:**
```sql
-- Список всех БД
SHOW DATABASES;

-- Информация о конкретной БД
SHOW CREATE DATABASE ecommerce;

-- Статистика через information_schema
SELECT * FROM information_schema.SCHEMATA;
```

**PostgreSQL:**
```sql
-- Список БД
SELECT datname FROM pg_database;

-- Размер БД
SELECT pg_size_pretty(pg_database_size('ecommerce'));

-- Активные подключения
SELECT * FROM pg_stat_activity;
```

---

#### **5. Практические примеры**

**Создание тестовой среды:**
```sql
CREATE DATABASE test_env 
CHARACTER SET utf8mb4;

-- Через 1 год...
ALTER DATABASE test_env 
RENAME TO archive_test_2023;

-- После анализа...
DROP DATABASE IF EXISTS archive_test_2023;
```

**Резервное копирование (через командную строку):**
```bash
# MySQL
mysqldump -u root -p ecommerce > backup.sql

# PostgreSQL
pg_dump -U postgres ecommerce > backup.sql
```

---

#### **6. Ограничения и безопасность**

**Лимиты:**
- MySQL: макс. длина имени - 64 символа
- PostgreSQL: 63 символа (идентификаторы)

**Права доступа:**
```sql
-- MySQL
GRANT ALL PRIVILEGES ON ecommerce.* TO 'user'@'localhost';

-- PostgreSQL
GRANT CONNECT ON DATABASE ecommerce TO app_user;
```

**Важные предостережения:**
1. Не используйте `root`/`postgres` для приложений
2. Регулярно делайте бэкапы
3. Ограничивайте права минимально необходимыми

---

#### **7. Сравнение MySQL и PostgreSQL**

| Операция            | MySQL                        | PostgreSQL                   |
| ------------------- | ---------------------------- | ---------------------------- |
| Создание БД         | `CREATE DATABASE shop`       | `CREATE DATABASE shop`       |
| Удаление            | `DROP DATABASE shop`         | `DROP DATABASE shop`         |
| Изменение кодировки | `ALTER DATABASE ... CHARSET` | `ALTER DATABASE ... CHARSET` |
| Просмотр списка     | `SHOW DATABASES`             | `\l` или `SELECT datname...` |

---

**См. также:**  
- [[Резервное копирование БД]]  
- [[Настройка производительности СУБД]]  
- [[Управление пользователями и правами]]  

**Дополнительные команды:**  
- `SHOW VARIABLES LIKE 'character_set_database';` (MySQL)  
- `UPDATE pg_database SET datallowconn = false WHERE datname = 'temp_db';` (PG)