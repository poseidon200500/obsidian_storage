---
tags:
  - Программирование
  - Теория_по_языку_Golang
  - Основы_языка_Golang
Связанные темы:
  - "[[Составные типы]]"
---

### **Структуры (struct) в Go**  

---

## **1. Основные понятия**  
Структура — составной тип данных, объединяющий поля разных типов под одним именем.  

### **Базовый синтаксис**  
```go
type User struct {
    ID       int
    Name     string
    Email    string
    IsActive bool
}

// Инициализация
user1 := User{
    ID:   1,
    Name: "Алиса",
}

// Доступ к полям
user1.Name = "Алиса Петрова"
```

### **Нулевое значение**  
Каждое поле получает нулевое значение своего типа:  
```go
var u User 
fmt.Println(u) // {0 "" "" false}
```

---

## **2. Ключевые особенности**  

### **a) Вложенные структуры**  
```go
type Address struct {
    City    string
    Country string
}

type Person struct {
    Name    string
    Address Address
}

p := Person{
    Name: "Боб",
    Address: Address{
        City:    "Москва",
        Country: "Россия",
    },
}
```

### **b) Теги полей**  
Используются для метаданных (JSON, БД и т.д.):  
```go
type Book struct {
    Title  string `json:"title" db:"book_title"`
    Author string `json:"author" validate:"required"`
}
```

### **c) Анонимные поля (встраивание)**  
```go
type Admin struct {
    User       // Встраивание
    Privileges []string
}

admin := Admin{
    User: User{ID: 1, Name: "Админ"},
}
fmt.Println(admin.Name) // Доступ к встроенному полю
```

---

## **3. Опасные моменты**  

### **a) Сравнение структур**  
Структуры сравниваемы, только если все их поля сравниваемы:  
```go
type Point struct { X, Y int }

p1 := Point{1, 2}
p2 := Point{1, 2}
fmt.Println(p1 == p2) // true

type Data struct { Values []int }
d1 := Data{[]int{1}}
d2 := Data{[]int{1}}
fmt.Println(d1 == d2) // Ошибка: нельзя сравнить
```

### **b) Указатели на структуры**  
Распространённый источник ошибок:  
```go
u := &User{ID: 1}
u = nil
u.ID = 2 // panic: nil pointer dereference
```

### **c) Копирование больших структур**  
Может привести к неэффективному использованию памяти:  
```go
var bigStruct BigData
copy := bigStruct // Полное копирование всех полей
```

---

## **4. Практические рекомендации**  

1. **Использование указателей:**  
   ```go
   func (u *User) UpdateName(name string) {
       u.Name = name
   }
   ```

2. **Конструкторы:**  
   ```go
   func NewUser(id int, name string) *User {
       return &User{
           ID:   id,
           Name: name,
       }
   }
   ```

3. **Оптимизация памяти:**  
   - Располагайте поля от большего к меньшему для выравнивания  
   - Используйте `[N]byte` вместо `string` для фиксированных данных  

---

## **5. Производительность**  

### **a) Размер структуры**  
```go
type Example struct {
    A int32    // 4 байта
    B float64  // 8 байт
    C bool     // 1 байт
}
// Общий размер: 24 байта (из-за выравнивания)
```


---

## **Связи с другими темами**  
→ [[pointers]] (указатели на структуры)  
→ [[interfaces]] (структуры как реализации интерфейсов)  
→ [[json]] (сериализация структур)  

**Дополнительно:**  
- [Официальная документация](https://go.dev/ref/spec#Struct_types)  
- [Effective Go: Структуры](https://go.dev/doc/effective_go#structs)  

---

Файл готов для сохранения в Obsidian. Подзаметки для углубления:  
- `structs/memory_layout.md`  
- `structs/methods.md`  
- `structs/tags.md`